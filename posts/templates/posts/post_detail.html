{% extends 'base.html' %}

{% block title %}{{ post.title }} - Mon RÃ©seau Social{% endblock %}

{% block content %}
  <h2>{{ post.title }}</h2>
  <p>Par {{ post.author.username }} dans <a href="{% url 'community_detail' pk=post.community.pk %}">{{ post.community.name }}</a></p>
  {% if post.image %}
    <img src="{{ post.image.url }}" alt="Image du post">
  {% endif %}
  <p>{{ post.content }}</p>
  <p>Score : {{ post.score }}</p>
  <p>
    <form method="post" action="{% url 'vote' post_id=post.pk vote_type=1 %}">
      {% csrf_token %}
      <button type="submit">Upvote</button>
    </form>
    <form method="post" action="{% url 'vote' post_id=post.pk vote_type=-1 %}">
      {% csrf_token %}
      <button type="submit">Downvote</button>
    </form>
  </p>

  <h3>Commentaires</h3>
  {% include 'posts/comment_list.html' with comments=post.comments.all %}
  
  <h3>Ajouter un commentaire</h3>
  <form method="post">
      {% csrf_token %}
      {{ comment_form.as_p }}
      <button type="submit">Commenter</button>
  </form>

  {% if user == post.author %}
    <a href="{% url 'delete_post' pk=post.pk %}" class="delete-button">Supprimer ce post</a>
  {% endif %}

{% endblock %}
